let timesinceACTIVE = 0
let HIT = 0
let command = ""
input.onGesture(Gesture.ThreeG, function () {
    if (command == "ACTIVE") {
        HIT = 1
        command = "END"
        basic.showIcon(IconNames.Ghost)
    }
})
basic.showIcon(IconNames.Sad)
bluetooth.startUartService()
HIT = 0
command = "WAIT"
basic.forever(function () {
    command = bluetooth.uartReadUntil(serial.delimiters(Delimiters.NewLine))
    if (command == "RESET") {
        HIT = 0
    }
    if (HIT == 1) {
        bluetooth.uartWriteString("HIT")
    } else {
        if (command == "BEGIN") {
            timesinceACTIVE = input.runningTime()
            basic.showIcon(IconNames.StickFigure)
        }
        if (command == "ACTIVE") {
            basic.showIcon(IconNames.StickFigure)
            if (input.runningTime() - timesinceACTIVE >= 30000) {
                command = "WAIT"
            }
        }
        if (command == "WAIT" || command == "END") {
            basic.showIcon(IconNames.No)
        }
    }
})
